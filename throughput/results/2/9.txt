BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%mint%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264390120.816657
 ALGERIA                   |   1997 |  456550408.19331
 ALGERIA                   |   1996 | 461708504.202815
 ALGERIA                   |   1995 | 464755752.028027
 ALGERIA                   |   1994 | 453868837.070653
 ALGERIA                   |   1993 | 460690713.792524
 ALGERIA                   |   1992 | 457198408.611036
 ARGENTINA                 |   1998 | 271347543.495648
 ARGENTINA                 |   1997 | 466654702.763728
 ARGENTINA                 |   1996 |  472505645.54085
 ARGENTINA                 |   1995 | 470575695.440867
 ARGENTINA                 |   1994 | 465731039.094208
 ARGENTINA                 |   1993 | 461604801.867931
 ARGENTINA                 |   1992 | 465382792.354413
 BRAZIL                    |   1998 | 275398916.671372
 BRAZIL                    |   1997 | 473806236.130838
 BRAZIL                    |   1996 |  471132031.77157
 BRAZIL                    |   1995 | 471038757.565693
 BRAZIL                    |   1994 | 468439205.091623
 BRAZIL                    |   1993 | 472862580.023864
 BRAZIL                    |   1992 | 466584448.069947
 CANADA                    |   1998 | 273638849.730866
 CANADA                    |   1997 | 477347469.496138
 CANADA                    |   1996 | 479653283.479914
 CANADA                    |   1995 | 473380846.130208
 CANADA                    |   1994 | 476765748.575356
 CANADA                    |   1993 | 475633305.880817
 CANADA                    |   1992 | 474868557.502075
 CHINA                     |   1998 |   269602347.5034
 CHINA                     |   1997 | 465436104.188789
 CHINA                     |   1996 | 459725955.313409
 CHINA                     |   1995 | 461334210.211842
 CHINA                     |   1994 | 461988878.635732
 CHINA                     |   1993 | 461333090.590401
 CHINA                     |   1992 | 465078369.945737
 EGYPT                     |   1998 | 271236161.348954
 EGYPT                     |   1997 | 458587889.759068
 EGYPT                     |   1996 | 461359637.467269
 EGYPT                     |   1995 | 455558043.396673
 EGYPT                     |   1994 | 455870910.578369
 EGYPT                     |   1993 | 470017304.084293
 EGYPT                     |   1992 | 459065253.090415
 ETHIOPIA                  |   1998 | 268142565.052086
 ETHIOPIA                  |   1997 | 444268833.085566
 ETHIOPIA                  |   1996 | 456650322.727399
 ETHIOPIA                  |   1995 | 461588330.134875
 ETHIOPIA                  |   1994 | 462370852.591194
 ETHIOPIA                  |   1993 |  449323099.60442
 ETHIOPIA                  |   1992 |  457975778.76864
 FRANCE                    |   1998 |  265106901.01676
 FRANCE                    |   1997 |   462703986.8253
 FRANCE                    |   1996 | 462175230.929008
 FRANCE                    |   1995 |  460831936.37472
 FRANCE                    |   1994 | 469035385.405226
 FRANCE                    |   1993 | 461097363.102528
 FRANCE                    |   1992 | 466302448.516801
 GERMANY                   |   1998 | 276680649.254193
 GERMANY                   |   1997 | 481803726.576306
 GERMANY                   |   1996 | 481786417.331764
 GERMANY                   |   1995 | 473412505.919053
 GERMANY                   |   1994 |  471587208.56946
 GERMANY                   |   1993 | 473194294.466459
 GERMANY                   |   1992 | 475718645.706461
 INDIA                     |   1998 | 279118241.018236
 INDIA                     |   1997 | 472557417.386336
 INDIA                     |   1996 |  475445689.89027
 INDIA                     |   1995 | 474708304.050116
 INDIA                     |   1994 | 474314823.704853
 INDIA                     |   1993 | 471235315.449053
 INDIA                     |   1992 | 482561626.114937
 INDONESIA                 |   1998 | 270720780.052511
 INDONESIA                 |   1997 | 457867403.891596
 INDONESIA                 |   1996 | 467927980.564053
 INDONESIA                 |   1995 | 452560321.304613
 INDONESIA                 |   1994 | 458639652.591765
 INDONESIA                 |   1993 | 458346722.447024
 INDONESIA                 |   1992 | 458792468.850542
 IRAN                      |   1998 | 265781698.339613
 IRAN                      |   1997 | 455572382.391656
 IRAN                      |   1996 | 461720008.104111
 IRAN                      |   1995 |  452499612.89982
 IRAN                      |   1994 | 456840765.058757
 IRAN                      |   1993 | 459268734.255089
 IRAN                      |   1992 | 461275143.033235
 IRAQ                      |   1998 | 272310916.000844
 IRAQ                      |   1997 | 464605509.420373
 IRAQ                      |   1996 | 468960232.915195
 IRAQ                      |   1995 | 464935229.501447
 IRAQ                      |   1994 | 474969988.678773
 IRAQ                      |   1993 | 465911193.663102
 IRAQ                      |   1992 | 466087186.559538
 JAPAN                     |   1998 | 270659897.097667
 JAPAN                     |   1997 | 459489705.788424
 JAPAN                     |   1996 | 459699912.561335
 JAPAN                     |   1995 | 466716534.616475
 JAPAN                     |   1994 | 459170024.751491
 JAPAN                     |   1993 | 462956247.477717
 JAPAN                     |   1992 | 464348694.315869
 JORDAN                    |   1998 | 273371696.216082
 JORDAN                    |   1997 | 455796720.138642
 JORDAN                    |   1996 | 460430490.818774
 JORDAN                    |   1995 | 459923102.429659
 JORDAN                    |   1994 |  459421356.92354
 JORDAN                    |   1993 | 457639692.182119
 JORDAN                    |   1992 | 450363678.445045
 KENYA                     |   1998 | 280035242.970977
 KENYA                     |   1997 | 473675294.836201
 KENYA                     |   1996 | 481424541.133216
 KENYA                     |   1995 | 469066485.434506
 KENYA                     |   1994 |  484278085.31685
 KENYA                     |   1993 | 469572249.502795
 KENYA                     |   1992 | 472351317.471301
 MOROCCO                   |   1998 | 270141128.514696
 MOROCCO                   |   1997 | 445916861.873904
 MOROCCO                   |   1996 |  456978829.67213
 MOROCCO                   |   1995 | 468312716.560926
 MOROCCO                   |   1994 | 458145503.137702
 MOROCCO                   |   1993 | 455389995.309842
 MOROCCO                   |   1992 | 462435985.755842
 MOZAMBIQUE                |   1998 | 274077080.619475
 MOZAMBIQUE                |   1997 | 458038674.530368
 MOZAMBIQUE                |   1996 | 467956282.825102
 MOZAMBIQUE                |   1995 | 463560181.386595
 MOZAMBIQUE                |   1994 | 465177638.664899
 MOZAMBIQUE                |   1993 | 470800872.213942
 MOZAMBIQUE                |   1992 | 462909325.994676
 PERU                      |   1998 | 272887570.727675
 PERU                      |   1997 | 472735528.767908
 PERU                      |   1996 | 468498462.549762
 PERU                      |   1995 | 467410912.513805
 PERU                      |   1994 | 470715371.892932
 PERU                      |   1993 | 463534198.681997
 PERU                      |   1992 |  466472585.57838
 ROMANIA                   |   1998 | 276508605.773463
 ROMANIA                   |   1997 | 464883849.033455
 ROMANIA                   |   1996 | 471353832.582458
 ROMANIA                   |   1995 | 468583060.208487
 ROMANIA                   |   1994 | 468189757.788104
 ROMANIA                   |   1993 | 475317234.897859
 ROMANIA                   |   1992 | 469254021.161468
 RUSSIA                    |   1998 | 273451252.670391
 RUSSIA                    |   1997 |  460673582.78386
 RUSSIA                    |   1996 | 470900563.328161
 RUSSIA                    |   1995 | 460165138.665155
 RUSSIA                    |   1994 | 460800765.037773
 RUSSIA                    |   1993 | 469162070.993814
 RUSSIA                    |   1992 | 459826505.100132
 SAUDI ARABIA              |   1998 | 270089247.758264
 SAUDI ARABIA              |   1997 | 475246592.701396
 SAUDI ARABIA              |   1996 | 465448031.470904
 SAUDI ARABIA              |   1995 | 470351873.930884
 SAUDI ARABIA              |   1994 | 466723399.947427
 SAUDI ARABIA              |   1993 | 473189441.546361
 SAUDI ARABIA              |   1992 | 473995012.376343
 UNITED KINGDOM            |   1998 | 265544951.037021
 UNITED KINGDOM            |   1997 | 460178738.674649
 UNITED KINGDOM            |   1996 | 448765124.911058
 UNITED KINGDOM            |   1995 | 457982592.129565
 UNITED KINGDOM            |   1994 | 453043192.850824
 UNITED KINGDOM            |   1993 | 455156732.930969
 UNITED KINGDOM            |   1992 | 455617742.852107
 UNITED STATES             |   1998 | 283720396.492787
 UNITED STATES             |   1997 |  480901204.45884
 UNITED STATES             |   1996 | 474865866.360021
 UNITED STATES             |   1995 | 472133754.826731
 UNITED STATES             |   1994 | 482393816.964181
 UNITED STATES             |   1993 | 476384935.801397
 UNITED STATES             |   1992 | 471012735.062441
 VIETNAM                   |   1998 | 278322715.299288
 VIETNAM                   |   1997 | 463849572.242678
 VIETNAM                   |   1996 | 465986434.563271
 VIETNAM                   |   1995 | 466443339.898219
 VIETNAM                   |   1994 | 469341638.081541
 VIETNAM                   |   1993 | 466080485.890089
 VIETNAM                   |   1992 | 468422739.618161
(175 rows)

COMMIT;
COMMIT
